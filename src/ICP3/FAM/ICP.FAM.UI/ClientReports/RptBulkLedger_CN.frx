<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" StartReportEvent="_StartReport" ReportInfo.Created="09/03/2011 09:19:42" ReportInfo.Modified="02/14/2019 10:22:09" ReportInfo.CreatorVersion="2013.2.5.0">
  <ScriptText>using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;
using System.Drawing;
using System.Data;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;

namespace FastReport
{
  public class ReportScript
  {
     

    private void _StartReport(object sender, EventArgs e)
    {       
      DataSourceBase dt=(Report.GetDataSource(&quot;HdReportSource&quot;) as DataSourceBase);
      if (dt!=null)
      {
        dt.Init();
        int hdType=Convert.ToInt32(dt[&quot;HdType&quot;]);
        if (hdType==0 || hdType==1 || hdType==2)    
        {
          Footer.Visible=true;
          FooterWriteOff.Visible=false;
        }
        else  //只有报销记录的凭证
        {
          Footer.Visible=false;
          FooterWriteOff.Visible=true;
        }
      }   
    }
  }
}
</ScriptText>
  <Dictionary>
    <BusinessObjectDataSource Name="HdReportSource" ReferenceName="HdReportSource" DataType="System.Int32" Enabled="true">
      <Column Name="ID" DataType="System.String"/>
      <Column Name="No" DataType="System.String"/>
      <Column Name="ReceiptQty" DataType="System.Int32"/>
      <Column Name="Creator" DataType="System.DateTime"/>
      <Column Name="DATE" DataType="System.String"/>
      <Column Name="Accountant" DataType="System.String"/>
      <Column Name="Cashier" DataType="System.String"/>
      <Column Name="Accountant" DataType="System.String"/>
      <Column Name="FinanceManager" DataType="System.String"/>
      <Column Name="Transactor" DataType="System.String"/>
      <Column Name="GeneralManager" DataType="System.String"/>
      <Column Name="Auditor" DataType="System.String"/>
      <Column Name="Organization" DataType="System.String"/>
      <Column Name="Currency" DataType="System.String"/>
      <Column Name="FiguresAmount" DataType="System.String"/>
      <Column Name="CompanyShortCode" DataType="System.String"/>
      <Column Name="MasterID" DataType="System.String"/>
      <Column Name="GLFullName" DataType="System.String"/>
      <Column Name="Remark" DataType="System.String"/>
      <Column Name="OrgAmt" DataType="System.Decimal"/>
      <Column Name="Rate" DataType="System.Decimal"/>
      <Column Name="CRAmt" DataType="System.Decimal"/>
      <Column Name="DRAmt" DataType="System.Decimal"/>
      <Column Name="Customer" DataType="System.String"/>
      <Column Name="Dept" DataType="System.String"/>
      <Column Name="Personal" DataType="System.String"/>
      <Column Name="UpdateDate" DataType="System.DateTime"/>
      <Column Name="TotalCRAmt" DataType="System.String"/>
      <Column Name="TotalDRAmt" DataType="System.String"/>
      <Column Name="Page" DataType="System.String"/>
      <Column Name="TotalPages" DataType="System.String"/>
    </BusinessObjectDataSource>
    <Total Name="TotalCRAmt" Expression="[HdReportSource.CRAmt]" Evaluator="table1"/>
    <Total Name="TotalDRAmt" Expression="[HdReportSource.DRAmt]" Evaluator="table1"/>
  </Dictionary>
  <ReportPage Name="Page1651288053" PaperWidth="215" PaperHeight="139.7" TopMargin="5" FirstPageSource="15" OtherPagesSource="15" Guides="793.8,812.7,822.15,831.6,822.15,822.15,812.7,812.7,803.25,812.7,812.7,831.6,774.9">
    <GroupHeaderBand Name="GroupHeader1" Width="737.1" Visible="false" StartNewPage="true" KeepWithData="true" Condition="[HdReportSource.No]">
      <DataBand Name="table1" Top="125.18" Width="737.1" Height="49.36" CanGrow="true" DataSource="HdReportSource" KeepDetail="true">
        <TableObject Name="Table12" Left="3.78" Top="0.22" Width="729.42" Height="49.14" Border.Lines="All" WrappedGap="378">
          <TableColumn Name="Column80" Width="182.39"/>
          <TableColumn Name="Column81" Width="231.53"/>
          <TableColumn Name="Column82" Width="80.26"/>
          <TableColumn Name="Column83" Width="57.6"/>
          <TableColumn Name="Column84" Width="89.82"/>
          <TableColumn Name="Column85" Width="87.82"/>
          <TableRow Name="Row21" Height="49.14">
            <TableCell Name="Cell135" Border.Lines="Right" Text="[HdReportSource.Remark]" VertAlign="Center" Font="宋体, 10pt"/>
            <TableCell Name="Cell136" Border.Lines="Right" Text="[HdReportSource.GLFullName]" VertAlign="Center" Font="宋体, 10pt"/>
            <TableCell Name="Cell137" Border.Lines="Right" Text="[HdReportSource.OrgAmt]" Format="Currency" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator="," Format.CurrencySymbol="" Format.PositivePattern="0" Format.NegativePattern="2" HorzAlign="Right" VertAlign="Center" Font="宋体, 10pt"/>
            <TableCell Name="Cell138" Border.Lines="Right" Text="[HdReportSource.Rate]" HorzAlign="Right" VertAlign="Center" Font="宋体, 10pt"/>
            <TableCell Name="Cell139" Border.Lines="Right" Text="[HdReportSource.DRAmt]" Format="Currency" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator="," Format.CurrencySymbol="" Format.PositivePattern="0" Format.NegativePattern="2" HorzAlign="Right" VertAlign="Center" Font="宋体, 10pt"/>
            <TableCell Name="Cell140" Text="[HdReportSource.CRAmt]" Format="Currency" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator="," Format.CurrencySymbol="" Format.PositivePattern="0" Format.NegativePattern="2" HorzAlign="Right" VertAlign="Center" Font="宋体, 10pt"/>
          </TableRow>
        </TableObject>
        <DataHeaderBand Name="DataHeader1" Top="4" Width="737.1" Height="117.18" KeepWithData="true" RepeatOnEveryPage="true">
          <TextObject Name="Text1" Left="3.78" Width="729.54" Height="26.46" Text="记账凭证" HorzAlign="Center" Font="宋体, 20pt, style=Bold"/>
          <TextObject Name="Text2" Left="614.25" Top="5.67" Width="47.36" Height="19" CanGrow="true" Text="[HdReportSource.Currency]" VertAlign="Center" Font="宋体, 10pt"/>
          <TextObject Name="Text3" Left="559.44" Top="5.67" Width="52.92" Height="19" CanGrow="true" Text="本币：" HorzAlign="Right" VertAlign="Center" Font="宋体, 10pt"/>
          <TextObject Name="Text4" Left="710.64" Top="5.67" Width="20.9" Height="19" CanGrow="true" Text="元" VertAlign="Center" Font="宋体, 10pt"/>
          <TextObject Name="Text5" Left="659.61" Top="5.67" Width="52.92" Height="19" CanGrow="true" Text="单位：" HorzAlign="Right" VertAlign="Center" Font="宋体, 10pt"/>
          <LineObject Name="Line2" Left="247.59" Top="30.24" Width="230.58" Border.Style="Dash" Border.Width="2"/>
          <TextObject Name="textbox30" Left="309.96" Top="34.02" Width="113.51" Height="15.12" Text="[HdReportSource.DATE]" Font="宋体, 10pt"/>
          <TableObject Name="Table3" Left="3.78" Top="49.36" Width="729.58" Height="37.8">
            <TableColumn Name="Column64" Width="364.79"/>
            <TableColumn Name="Column65" Width="364.79"/>
            <TableRow Name="Row16">
              <TableCell Name="Cell112" Text="编制单位：[HdReportSource.Organization]" VertAlign="Center"/>
              <TableCell Name="Cell113" VertAlign="Center"/>
            </TableRow>
            <TableRow Name="Row17">
              <TableCell Name="Cell117" VertAlign="Center"/>
              <TableCell Name="Cell118" Text="[HdReportSource.CompanyShortCode]第[HdReportSource.No]号 -[HdReportSource.Page]/[HdReportSource.TotalPages]" HorzAlign="Right" VertAlign="Center"/>
            </TableRow>
          </TableObject>
          <TableObject Name="Table13" Left="3.78" Top="86.94" Width="729.42" Height="30.24" Border.Lines="All" WrappedGap="378">
            <TableColumn Name="Column86" Width="182.39"/>
            <TableColumn Name="Column87" Width="231.53"/>
            <TableColumn Name="Column88" Width="80.26"/>
            <TableColumn Name="Column89" Width="57.6"/>
            <TableColumn Name="Column90" Width="89.82"/>
            <TableColumn Name="Column91" Width="87.82"/>
            <TableRow Name="Row22" Height="30.24">
              <TableCell Name="Cell141" Border.Lines="Right" Text="摘  要" HorzAlign="Center" VertAlign="Center" Font="宋体, 12pt"/>
              <TableCell Name="Cell142" Border.Lines="Right" Text="会 计 科 目" HorzAlign="Center" VertAlign="Center" Font="宋体, 12pt"/>
              <TableCell Name="Cell143" Border.Lines="Right" Text="原币" HorzAlign="Center" VertAlign="Center" Font="宋体, 12pt"/>
              <TableCell Name="Cell144" Border.Lines="Right" Text="汇率" HorzAlign="Center" VertAlign="Center" Font="宋体, 12pt"/>
              <TableCell Name="Cell145" Border.Lines="Right" Text="借方金额" HorzAlign="Center" VertAlign="Center" Font="宋体, 12pt"/>
              <TableCell Name="Cell146" Text="贷方金额" HorzAlign="Center" VertAlign="Center" Font="宋体, 12pt"/>
            </TableRow>
          </TableObject>
        </DataHeaderBand>
        <Sort>
          <Sort Expression="[HdReportSource.Remark]"/>
          <Sort Expression="Abs([HdReportSource.DRAmt])" Descending="true"/>
          <Sort Expression="Abs([HdReportSource.CRAmt])" Descending="true"/>
        </Sort>
      </DataBand>
      <GroupFooterBand Name="GroupFooter1" Top="178.54" Width="737.1" Height="60.48" KeepWithData="true" RepeatOnEveryPage="true">
        <TableObject Name="FooterWriteOff" Left="3.78" Top="37.8" Width="729.55" Height="22.68">
          <TableColumn Name="Column17" Width="73.28"/>
          <TableColumn Name="Column18" Width="82.72"/>
          <TableColumn Name="Column19" Width="60.05"/>
          <TableColumn Name="Column20" Width="82.72"/>
          <TableColumn Name="Column21" Width="86.5"/>
          <TableColumn Name="Column22" Width="78.94"/>
          <TableColumn Name="Column34" Width="45.53"/>
          <TableColumn Name="Column35" Width="81.46"/>
          <TableColumn Name="Column36" Width="60.67"/>
          <TableColumn Name="Column37" Width="77.68"/>
          <TableRow Name="Row10" Height="22.68">
            <TableCell Name="Cell45" Text="财务主管:" Font="宋体, 10pt"/>
            <TableCell Name="Cell46" Text="[HdReportSource.FinanceManager]"/>
            <TableCell Name="Cell47" Text="总经理:" HorzAlign="Right" Font="宋体, 10pt"/>
            <TableCell Name="Cell48" Text="[HdReportSource.GeneralManager]"/>
            <TableCell Name="Cell49" Text="财务审批人:" HorzAlign="Right" Font="宋体, 10pt"/>
            <TableCell Name="Cell70" Text="[HdReportSource.Auditor]"/>
            <TableCell Name="Cell82" Text="出纳:" HorzAlign="Right"/>
            <TableCell Name="Cell83" Text="[HdReportSource.Cashier]"/>
            <TableCell Name="Cell84" Text="报销人:" HorzAlign="Right"/>
            <TableCell Name="Cell85" Text="[HdReportSource.Transactor]"/>
          </TableRow>
        </TableObject>
        <TableObject Name="Table10" Left="3.78" Width="729.42" Height="37.8" Border.Lines="All" WrappedGap="378">
          <TableColumn Name="Column58" Width="182.39"/>
          <TableColumn Name="Column59" Width="231.53"/>
          <TableColumn Name="Column60" Width="80.26"/>
          <TableColumn Name="Column61" Width="57.6"/>
          <TableColumn Name="Column62" Width="89.82"/>
          <TableColumn Name="Column63" Width="87.82"/>
          <TableRow Name="Row15" Height="37.8">
            <TableCell Name="Cell106" Border.Lines="Right" Text="附单据数 [HdReportSource.ReceiptQty] 张" VertAlign="Center" Font="宋体, 10pt"/>
            <TableCell Name="Cell107" Border.Lines="Right" Text="合计 [HdReportSource.FiguresAmount]" VertAlign="Center" Font="宋体, 10pt"/>
            <TableCell Name="Cell108" Border.Lines="Right" VertAlign="Center" Font="宋体, 10pt"/>
            <TableCell Name="Cell109" Border.Lines="Right" VertAlign="Center" Font="宋体, 10pt"/>
            <TableCell Name="Cell110" Border.Lines="Right" Text="[HdReportSource.TotalDRAmt]" Format="Currency" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator="," Format.CurrencySymbol="" Format.PositivePattern="0" Format.NegativePattern="2" HorzAlign="Right" VertAlign="Center" Font="宋体, 10pt"/>
            <TableCell Name="Cell111" Text="[HdReportSource.TotalCRAmt]" Format="Currency" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator="," Format.CurrencySymbol="" Format.PositivePattern="0" Format.NegativePattern="2" HorzAlign="Right" VertAlign="Center" Font="宋体, 10pt"/>
          </TableRow>
        </TableObject>
        <TableObject Name="Footer" Left="3.78" Top="37.8" Width="729.23" Height="22.68">
          <TableColumn Name="Column92" Width="76.83"/>
          <TableColumn Name="Column93" Width="63.59"/>
          <TableColumn Name="Column94" Width="48.5"/>
          <TableColumn Name="Column95" Width="67.37"/>
          <TableColumn Name="Column96" Width="48.5"/>
          <TableColumn Name="Column97" Width="67.4"/>
          <TableColumn Name="Column98" Width="49.12"/>
          <TableColumn Name="Column99" Width="66.12"/>
          <TableColumn Name="Column100" Width="49.12"/>
          <TableColumn Name="Column101" Width="66.12"/>
          <TableColumn Name="Column38" Width="64.22"/>
          <TableColumn Name="Column39" Width="62.34"/>
          <TableRow Name="Row23" Height="22.68">
            <TableCell Name="Cell147" Text="财务主管:" Font="宋体, 10pt"/>
            <TableCell Name="Cell148" Text="[HdReportSource.FinanceManager]"/>
            <TableCell Name="Cell149" Text="记账:" HorzAlign="Right" Font="宋体, 10pt"/>
            <TableCell Name="Cell150" Text="[HdReportSource.Accountant]"/>
            <TableCell Name="Cell151" Text="复核:" HorzAlign="Right" Font="宋体, 10pt"/>
            <TableCell Name="Cell152" Text="[HdReportSource.Auditor]"/>
            <TableCell Name="Cell153" Text="出纳:" HorzAlign="Right"/>
            <TableCell Name="Cell154" Text="[HdReportSource.Cashier]"/>
            <TableCell Name="Cell155" Text="制单:" HorzAlign="Right"/>
            <TableCell Name="Cell156" Text="[HdReportSource.Creator]"/>
            <TableCell Name="Cell86" Text="经办人:" HorzAlign="Right"/>
            <TableCell Name="Cell87" Text="[HdReportSource.Transactor]"/>
          </TableRow>
        </TableObject>
      </GroupFooterBand>
    </GroupHeaderBand>
  </ReportPage>
</Report>
